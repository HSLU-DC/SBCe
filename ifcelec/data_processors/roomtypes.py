import pandas as pd

def roomtypes(ifc_rooms, matrix_path):
    new_rooms = {}

    # Read Matrix
    print("\tReading Matrix " + matrix_path)
    df = pd.read_excel(matrix_path, sheet_name='Alias')

    # Reset the DataFrame's index
    df = df.reset_index(drop=True)

    print("\tAssigning Roomtypes")
    # Assigning Roomtype per Room
    for i in range(0, len(ifc_rooms)):
        room = str(ifc_rooms[i].name)  # Access 'name' attribute of Room instance
        words = room.split()
        Roomtype = ""
        for word in words:
            match = df.isin([word])
            location = match.any()
            if location.any():
                Roomtype = location[location].index[0]
                break
        if Roomtype == "":
            Roomtype = "Unknown"
            print("\t\t- Unknown Roomtype for " + room + "! (Append Room name to Matrix)")

        new_rooms[room] = Roomtype
            
    print("\tRoomtype assignment finished\n")
    return new_rooms

if __name__ == "__main__":
    roomtypes([{'name': 'Einbringöffnung / Anlieferung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik (Sprinkler)', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lift', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Waschen, Trocken', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Vorraum', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik (Energy-Hub)', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Vorraum', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik (Eawag)', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe West', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Ost', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lift', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Nord', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Sitzungszimmer', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC Herren', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC Damen', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lager', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Windfang', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Büro', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Empfang', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Windfang', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Atrium', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Süd', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Sitzungszimmer', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Windfang', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lift', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lift', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Präsentation', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Nord', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Süd', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Büro', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Nord', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Aufenthaltsraum / Teeküche', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Reinigung', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Raum', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Galerie', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Süd', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Terrasse', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Büro', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Catering, Küche', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Lift', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Nord', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'WC', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Treppe Süd', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Technik', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Galerie', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Multifunktionsraum', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Büro', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}, {'name': 'Raum', 'area': None, 'windows': None, 'doors': None, 'other_openings': None}], "./naming.xlsx")